# Enigma Database Encryption Solution

## 프로젝트 개요

**Enigma**는 Rust로 개발된 고성능 데이터베이스 암호화 솔루션입니다. 애플리케이션 계층과 데이터베이스 계층에서 모두 사용 가능하며, Java/Spring Boot 환경과 MySQL, Oracle 데이터베이스에 쉽게 통합할 수 있도록 설계되었습니다.

---

## 핵심 기능

### 1. 강력한 암호화 알고리즘

| 알고리즘 | 용도 | 설명 |
|---------|------|------|
| **AES-256-CBC** | 데이터 암호화/복호화 | 256비트 키를 사용하는 블록 암호화 (PKCS7 패딩) |
| **SHA-256/384/512** | 해시 함수 | 무결성 검증 및 일방향 암호화 |
| **MD5** | 해시 함수 | 레거시 호환성 지원 |

### 2. AWS KMS 통합 키 관리

- AWS KMS (Key Management Service)와 연동하여 마스터 키 보호
- `SYMMETRIC_DEFAULT` (AES-256-GCM) 사양 사용
- Seed 암호화/복호화를 통해 안전한 키 파생 관리
- 자격 증명 기반 세션 관리

### 3. 다중 플랫폼 지원

| 플랫폼 | 아키텍처 | 지원 여부 |
|--------|---------|----------|
| Windows | x86_64 (AMD64) | ✅ |
| Linux | x86_64 (AMD64) | ✅ |
| Linux | AARCH64 (ARM64) | ✅ |
| macOS | Apple Silicon (ARM64) | ✅ |

### 4. Java/JNI 통합

- **순수 Java JNI 라이브러리**: 최소 의존성으로 Java 애플리케이션에 쉬운 통합
- **JDK8 및 JDK11+ 지원**: 다양한 Java 버전 호환
- **Spring Boot 지원**: Spring Framework와 원활한 연동

### 5. 데이터베이스 UDF (User Defined Functions)

#### MySQL UDF
- 데이터베이스 수준에서 직접 암호화/복호화 수행
- 일반 암호화/복호화 함수 제공
- ID 기반 암호화/복호화 지원
- 해시 함수 제공

#### Oracle 통합
- Oracle JNI 라이브러리 지원
- 다양한 Oracle 버전 호환성 고려

### 6. 문자 인코딩 지원

- **UTF-8**: 기본 인코딩
- **CP949 (Windows-949/EUC-KR)**: 한국어 완벽 지원
- 설정 파일을 통해 인코딩 방식 지정 가능

### 7. 유연한 설정 및 구성

- JSON 기반 설정 파일
- Config 기반 암호화 세션 관리
- 여러 Cipher Spec 지원 (알고리즘, 블록 모드, 패딩, 출력 형식)
- Base64 및 Hex 출력 형식 지원

---

## 암호화 프로세스 흐름

```
[설정 생성]
1. Seed Byte 생성 (76바이트 랜덤)
2. Credential Key 생성 (SHA-256, 10라운드)
3. Credential IV 생성 (MD5, 10라운드)
4. Seed 암호화 (AWS KMS)
5. Credential 암호화 (AES-256-CBC)
6. Config 파일 생성 (Base64 인코딩)

[암호화/복호화]
1. Config 로드
2. Seed 복호화 (AWS KMS)
3. Credential Key/IV 재생성
4. Credential 복호화 → Cipher Spec 추출
5. 데이터 암호화/복호화 수행
```

---

## 성능 특성

암호화/복호화 적용 시 **성능 저하가 거의 없도록** 최적화되었습니다.

| 작업 | 미적용 RPS | 적용 RPS | 성능 저하 |
|-----|----------|---------|----------|
| 등록 (암호화) | 99.5 | 99.9 | 최소 |
| 조회 (복호화) | 93.9 | 95.3 | 최소 |

---

## 기술 스택

### Core
- **Rust 1.83.0**: 핵심 암호화 라이브러리
- **Gradle 8.14.3**: Java 라이브러리 빌드
- **Java 8+**: JNI 통합

### 주요 라이브러리
| 라이브러리 | 용도 |
|-----------|------|
| `aes`, `cbc` | AES 암호화 구현 |
| `ring` | 해시 알고리즘 |
| `aws-sdk-kms` | AWS KMS 연동 |
| `base64`, `hex`, `encoding` | 인코딩 처리 |
| `flapigen` | Rust FFI 생성 |
| `udf` | MySQL UDF 개발 |

---

## 프로젝트 구조

```
enigma-rust/
├── enigma-lib/          # Rust 핵심 라이브러리
│   ├── domain/          # 설정 및 Cipher Spec
│   ├── session/         # 암호화 세션 및 연산
│   ├── kms/             # AWS KMS 서비스
│   ├── util/            # 핵심 유틸리티
│   └── error/           # 에러 처리
├── enigma-build/        # JNI 빌드 및 테스트 모듈
│   ├── lib/             # Spring Boot JNI 라이브러리
│   └── oracle-lib/      # Oracle 라이브러리
├── enigma-udf/          # MySQL UDF
├── enigma-oracle-udf/   # Oracle UDF
└── flapigen/            # FFI 생성기 (포크 버전)
```

---

## 사용 사례

1. **Spring Boot 애플리케이션**: JNI 라이브러리를 통해 애플리케이션 레벨에서 개인정보 암호화
2. **MySQL 데이터베이스**: UDF를 통해 컬럼 레벨에서 직접 암호화/복호화
3. **Oracle 데이터베이스**: JNI를 통한 Oracle 데이터베이스 통합

---

## 보안 특성

- **강력한 암호화**: AES-256-CBC (미국 정부 표준)
- **안전한 키 관리**: AWS KMS를 통한 중앙화된 키 관리
- **키 파생**: 다중 라운드 해시 기반 키 파생
- **최소 의존성**: 보안 취약성을 최소화하는 순수 Rust/Java 구성

---

## 라이선스

내부 프로젝트로 개발되었습니다.

---

## 개발 환경

- **Build**: Cargo, Gradle, cross, Podman
- **버전 관리**: Git
- **테스트**: Rust 내장 테스트 프레임워크, Spring Boot 테스트 모듈

---

*이 프로젝트는 Gemini, Perplexity, Cursor AI를 활용하여 개발되었습니다.*
