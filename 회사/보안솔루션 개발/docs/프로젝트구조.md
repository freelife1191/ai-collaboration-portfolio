# enigma-rust

<!-- TOC -->
* [enigma-rust](#enigma-rust)
  * [ğŸš¦ Enigma Logo](#-enigma-logo)
  * [ğŸš¦ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê²°ê³¼](#-ì„±ëŠ¥-í…ŒìŠ¤íŠ¸-ê²°ê³¼)
  * [ğŸš¦ Enigma ì•”í˜¸í™” ì†”ë£¨ì…˜ í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ êµ¬ì¡°](#-enigma-ì•”í˜¸í™”-ì†”ë£¨ì…˜-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-êµ¬ì¡°)
  * [ğŸš¦ Specification](#-specification)
    * [â–º í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜](#-í”„ë¡œì íŠ¸ì—ì„œ-ì‚¬ìš©ë˜ëŠ”-ì•”í˜¸í™”-ì•Œê³ ë¦¬ì¦˜)
    * [â–º ì§€ì›ë˜ëŠ” MultiPlatform](#-ì§€ì›ë˜ëŠ”-multiplatform)
    * [â–º Rust í”„ë¡œì íŠ¸ êµ¬ì„±](#-rust-í”„ë¡œì íŠ¸-êµ¬ì„±)
  * [ğŸš¦ Gradle Build Command](#-gradle-build-command)
    * [`enigma-core` Library ë¹Œë“œ ë° Oracle Library ë¹Œë“œ ì‹œ ì£¼ì˜ ì‚¬í•­](#enigma-core-library-ë¹Œë“œ-ë°-oracle-library-ë¹Œë“œ-ì‹œ-ì£¼ì˜-ì‚¬í•­)
    * [â–º `enigma-core` Library ë¹Œë“œ](#-enigma-core-library-ë¹Œë“œ)
    * [â–º ì§€ì›ë˜ëŠ” íŒŒë¼ë©”í„°](#-ì§€ì›ë˜ëŠ”-íŒŒë¼ë©”í„°)
    * [â–º `enigma-core` Oracle Library ë¹Œë“œ](#-enigma-core-oracle-library-ë¹Œë“œ)
  * [ğŸš¦ UDF ì„¤ì¹˜ ë° ì ìš© ê°€ì´ë“œ ë¬¸ì„œ](#-udf-ì„¤ì¹˜-ë°-ì ìš©-ê°€ì´ë“œ-ë¬¸ì„œ)
    * [â–º MySQL](#-mysql)
    * [â–º Oracle](#-oracle)
<!-- TOC -->

Enigma DB ì•”í˜¸í™” ì†”ë£¨ì…˜ ë‚´ì¬í™” í”„ë¡œì íŠ¸ ì…ë‹ˆë‹¤  

ë³¸ í”„ë¡œì íŠ¸ëŠ” Rust ë¡œ ê°œë°œëœ ì•”í˜¸í™” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ JNI ë¡œ ë¹Œë“œí•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ë˜ì—ˆìŠµë‹ˆë‹¤

Cross Compile ì„ ìœ„í•´ `cross` ë¥¼ ì‚¬ìš©í•´ ì»´íŒŒì¼í•˜ë©° `podman` ì„ ì‚¬ìš©í•˜ì—¬ Docker í™˜ê²½ì„ êµ¬ì„±í•˜ê³  `flapigen` ì„ ì‚¬ìš©í•˜ì—¬ Rust FFI ë¥¼ ìƒì„±í•©ë‹ˆë‹¤

ìœ„ì˜ ê³¼ì •ì„ Gradle Task ë¡œ êµ¬ì„±í•˜ì—¬ ì‰½ê³  ë¹ ë¥´ê²Œ ë¹Œë“œí•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ë˜ì—ˆìŠµë‹ˆë‹¤

ì´ ì•”í˜¸í™” ì†”ë£¨ì…˜ì€ ì˜ì¡´ì„±ì„ ìµœì†Œí™”í•˜ì—¬ ìˆœìˆ˜ Java JNI ë¼ì´ë¸ŒëŸ¬ë¦¬ êµ¬ì„±ìœ¼ë¡œ Java Application ì—ì„œ ì‰½ê³  ë¹ ë¥´ê²Œ ì ìš©í•˜ê³  ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ë˜ì—ˆìœ¼ë©°   
ê°•ë ¥í•˜ê³  ì•ˆì „í•˜ê²Œ ì•”í˜¸í™”ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤


##  ğŸš¦ Enigma Logo

---

![Enigma Logo](docs/assets/img0.png)


## ğŸš¦ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê²°ê³¼

ì„±ëŠ¥ì´ ë›°ì–´ë‚˜ì„œ Application ì—ì„œ ì•”í˜¸í™”/ë³µí˜¸í™”ë¥¼ ìˆ˜í–‰ì‹œ ì„±ëŠ¥ ì €í•˜ê°€ ê±°ì˜ ì—†ìŠµë‹ˆë‹¤

ì•„ë˜ì˜ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ì°¸ê³ í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤

---

ì•„ë˜ì˜ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ë³´ë©´ ì•”í˜¸í™”/ë³µí˜¸í™”ë¥¼ ìˆ˜í–‰í•  ë•Œ ì„±ëŠ¥ ì €í•˜ê°€ ê±°ì˜ ì—†ìŒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

- ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì¡°ê±´
  - ì•”í˜¸í™” í…ŒìŠ¤íŠ¸ (100 RPS, 100 ê±´ Bulk Insert)
  - ë³µí˜¸í™” í…ŒìŠ¤íŠ¸ (100 RPS, 1000 ROW Select)

| ë“±ë¡ì‹œ ì•”í˜¸í™” ë¯¸ì ìš©      | ì¡°íšŒì‹œ ë³µí˜¸í™” ë¯¸ì ìš©       |
|:-----------------|:------------------|
| 99.5 / 100 RPS   | 93.9 / 100 RPS    |
| ìµœì†Œ 14ms, í‰ê·  23ms | ìµœì†Œ 60ms, í‰ê·  120ms |

| ë“±ë¡ì‹œ ì•”í˜¸í™” ì ìš©       | ì¡°íšŒì‹œ ë³µí˜¸í™” ì ìš©       |
|:-----------------|:-----------------|
| 99.9 / 100 RPS   | 95.3 / 100 RPS   |
| ìµœì†Œ 17ms, í‰ê·  27ms | ìµœì†Œ 44ms, í‰ê·  79ms |


## ğŸš¦ Enigma ì•”í˜¸í™” ì†”ë£¨ì…˜ í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ êµ¬ì¡°

---

- [Encryption Algorithm](docs/EncryptionAlgorithm.md)


## ğŸš¦ Specification

---

- [Rust 1.83.0](https://www.rust-lang.org/)
- [Gradle 8.14.3](https://gradle.org/)
- Java 8 ì´ìƒ
- [Podman 5.5.1](https://podman.io/)
- [flapigen 0.8.0](https://github.com/Dushistov/flapigen-rs)
- [cross 0.2.5](https://github.com/cross-rs/cross)

### â–º í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜

- AWS KMS: SYMMETRIC_DEFAULT(AES256-GCM)
- AES256-CBC
- SHA256
- MD5

### â–º ì§€ì›ë˜ëŠ” MultiPlatform

- **Windows**
  - x86_64(AMD64)
- **Linux**
  - x86_64(AMD64)
  - AARCH64(ARM64)
- **MacOS**
  - Apple Silicon(ARM64)

### â–º Rust í”„ë¡œì íŠ¸ êµ¬ì„±

- `enigma-build`
  - Cross Compile MultiPlatform JNI Build Module
  - [`enigma-jni-oracle-build`](enigma-build/enigma-jni-oracle-build)
    - Oracle JDK6 JNI Build Test Module
    - Oracle JNI Java ì½”ë“œì™€ ë¹Œë“œëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í…ŒìŠ¤íŠ¸ í•˜ê¸° ìœ„í•œ í”„ë¡œì íŠ¸
  - [`enigma-spring-build`](enigma-build/enigma-spring-build)
    - Spring Boot Build Test Module
    - Spring Boot JNI Java ì½”ë“œì™€ ë¹Œë“œëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í…ŒìŠ¤íŠ¸ í•˜ê¸° ìœ„í•œ í”„ë¡œì íŠ¸
  - [`enigma-spring-build-jdk1.8`](enigma-build/enigma-spring-build-jdk1.8)
    - Spring Boot JDK8 Build Test Module
    - Spring Boot JDK8 JNI Java ì½”ë“œì™€ ë¹Œë“œëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í…ŒìŠ¤íŠ¸ í•˜ê¸° ìœ„í•œ í”„ë¡œì íŠ¸
  - [`enigma-spring-test`](enigma-build/enigma-spring-test)
    - Spring Boot Test Module
    - AWS Repository ì— Publish ëœ enigma-core ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í…ŒìŠ¤íŠ¸ í•˜ê¸° ìœ„í•œ í”„ë¡œì íŠ¸
    - Tomcat ìš© War í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œë„ ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
  - [`enigma-spring-test-jdk1.8`](enigma-build/enigma-spring-test-jdk1.8)
    - Spring Boot JDK8 Test Module
    - AWS Repository ì— Publish ëœ enigma-core-jdk1.8 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í…ŒìŠ¤íŠ¸ í•˜ê¸° ìœ„í•œ í”„ë¡œì íŠ¸
    - Tomcat ìš© War í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œë„ ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
  - [`lib`](enigma-build/lib)
    - Spring Boot ìš© JNI Library Build Module
  - [`oracle-lib`](enigma-build/oracle-lib)ğŸš«
      - Oracle 11G JDK6(Glibc 2.17+) JNI Build Module
      - ëŒ€ë¶€ë¶„ì˜ Oracle 11G OS ê°€ Glibc 2.12 ì´í•˜ ë²„ì „ì„ ì‚¬ìš©í•˜ë¯€ë¡œ ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì‚¬ìš©ë¶ˆê°€
      - enigma-rust-legacy í”„ë¡œì íŠ¸ë¡œ ëŒ€ì²´
- [`enigma-lib`](enigma-lib)
  - Rust Library Core
- [`enigma-udf`](enigma-udf)
  - MySQL UDF(User Defined Function) Library Build Module
  - Rust [udf](https://docs.rs/udf/latest/udf/) ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ MySQL UDF ë¹Œë“œ
  - [sql-udf](https://github.com/pluots/sql-udf), [udf-suite](https://github.com/pluots/udf-suite)ì—ì„œ ìì„¸í•œ ì‚¬ìš©ë²• ì°¸ê³ 
- [`flapigen`](flapigen)
  - Rust FFI Generator Library
  - [flapigen](https://docs.rs/flapigen/latest/flapigen/) ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ Rust FFI ìƒì„±
  - [flapigen-rs](https://github.com/Dushistov/flapigen-rs) ì‚¬ìš©ë²• ì°¸ê³ 
- [`Dockerfile`](enigma-build/docker)
  - Oracle ë° MySQL UDF í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì„±ì„ ìœ„í•œ Docker ìŠ¤í¬ë¦½íŠ¸
  -  ì˜ Oracle ë° MySQL UDF ìŠ¤í¬ë¦½íŠ¸ ì°¸ê³ 


## ğŸš¦ Gradle Build Command

---

### `enigma-core` Library ë¹Œë“œ ë° Oracle Library ë¹Œë“œ ì‹œ ì£¼ì˜ ì‚¬í•­

> ë¹Œë“œ ëŒ€ìƒì„ `:lib` ë¡œ ì§€ì •í–ˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¹Œë“œë˜ëŠ” ê²½ìš°ê°€ ìˆì–´ ê°œë³„ ë¹Œë“œì‹œ ì£¼ì„ì²˜ë¦¬  
> ê°œë³„ ë¹Œë“œì‹œ ì„ì˜ë¡œ ì•„ë˜ì˜ íŒŒì¼ì—ì„œ ë¹Œë“œí•˜ì§€ ì•Šì„ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì£¼ì„ ì²˜ë¦¬ í›„ ë¹Œë“œ  

- [settings.gradle](enigma-build/settings.gradle)
- [build.gradle](enigma-build/build.gradle)

### â–º `enigma-core` Library ë¹Œë“œ

enigma-build í”„ë¡œì íŠ¸ ê²½ë¡œë¡œ ì´ë™

```shell
$ cd enigma-build
```

`enigma-core` Library ë¹Œë“œ ë° jar íŒŒì¼ ìƒì„± í›„ AWS S3 Repository ì— Publish
- output ê²½ë¡œ `enigma-build/output/enigma-core-0.1.0.RC1.jar`

```shell
$ ./gradlew :lib:clean :lib:build :lib:publish
```

### â–º ì§€ì›ë˜ëŠ” íŒŒë¼ë©”í„°

- `javaVersion`: java ë²„ì „ì´ 8ì¸ì§€ ì•„ë‹Œì§€ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•œ íŒŒë¼ë©”í„°
  - 8ì„ ì…ë ¥í•˜ë©´ JDK8 ì´ìƒì—ì„œ ì‚¬ìš©ê°€ëŠ¥í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìƒì„± í›„ Publish
    - output: `enigma-core-jdk8-0.1.1.RC1.jar`
  - ì…ë ¥í•˜ì§€ ì•Šìœ¼ë©´ JDK11 ì´ìƒì—ì„œ ì‚¬ìš©ê°€ëŠ¥í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒì„± í›„ Publish
    - output: `enigma-core-0.1.1.RC1.jar`
- `version`: enigma ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „
  - ì…ë ¥ê°’ëŒ€ë¡œ ë²„ì „ì„ ì§€ì •í•œë‹¤
  - ì…ë ¥í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ ë²„ì „ì´ ì ìš©ëœë‹¤


Gradle Build Command íŒŒë¼ë©”í„° ì…ë ¥ ì˜ˆ:

```shell
# javaVersion ì€ JDK8 ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì€ 0.1.0.RC1ë¡œ ì§€ì •
$ ./gradlew :lib:clean :lib:build :lib:publish -PjavaVersion=8 -Pversion=0.1.1.RC1 --warning-mode all

# javaVersion ì€ JDK8 ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì€ ê¸°ë³¸ ë²„ì „ ì§€ì •
$ ./gradlew :lib:clean :lib:build :lib:publish -PjavaVersion=8 --warning-mode all

# javaVersion ì€ ê¸°ë³¸ê°’ì¸ JDK11 ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì€ 0.1.0.RC1ë¡œ ì§€ì •
$ ./gradlew :lib:clean :lib:build :lib:publish -Pversion=0.1.1.RC1 --warning-mode all

# javaVersion ì€ ê¸°ë³¸ê°’ì¸ JDK11 ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì€ ê¸°ë³¸ ë²„ì „ ì§€ì •
$ ./gradlew :lib:clean :lib:build :lib:publish --warning-mode all
```

### â–º `enigma-core` Oracle Library ë¹Œë“œ

enigma-build í”„ë¡œì íŠ¸ ê²½ë¡œë¡œ ì´ë™

```shell
$ cd enigma-build
```

`enigma-core` Oracle Library ë¹Œë“œ ë° jar íŒŒì¼ ìƒì„±

```shell
$ ./gradlew :oracle-lib:clean :oracle-lib:build -x :oracle-lib:test
```


## ğŸš¦ UDF ì„¤ì¹˜ ë° ì ìš© ê°€ì´ë“œ ë¬¸ì„œ

---

### â–º MySQL

- [0. ì´ˆê¸° DB ì…‹íŒ…](docs/mysql/0.%20ì´ˆê¸°%20DB%20ì…‹íŒ….md)
- [1. MySQL 8.X UDF ì„¤ì¹˜ ë° ì ìš© ê°€ì´ë“œ](docs/mysql/1.%20MySQL%208.X%20UDF%20ì„¤ì¹˜%20ë°%20ì ìš©%20ê°€ì´ë“œ.md)

### â–º Oracle

- [ì´ˆê¸° DB ì…‹íŒ… ê°€ì´ë“œ](docs/oracle/0.%20ì´ˆê¸°%20DB%20ì…‹íŒ…%20ê°€ì´ë“œ.md)
- Enigma Oracle JNI ì ìš© ê°€ì´ë“œ
  - [Petra ì ìš© ê°€ì´ë“œ](docs/oracle/1.%20Enigma%20Oracle%20JNI%20ì ìš©%20ê°€ì´ë“œ%20for%20Petra.md)
  - [DAMO ì ìš© ê°€ì´ë“œ](docs/oracle/2.%20Enigma%20Oracle%20JNI%20ì ìš©%20ê°€ì´ë“œ%20for%20DAMO.md)
  - [CubeOne ì ìš© ê°€ì´ë“œ](docs/oracle/3.%20Enigma%20Oracle%20JNI%20ì ìš©%20ê°€ì´ë“œ%20for%20CubeOne.md)